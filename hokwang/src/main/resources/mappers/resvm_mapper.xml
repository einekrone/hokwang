<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hokwang.mobile.dao.ResvmMapper">
	<select id="getChildList" resultType="babyVO"
		parameterType="babyVO">
		SELECT * FROM BABY
		<where>
			<if test="parent_no != null and parent_no != ''">
				PARENT_NO = #{parent_no}
			</if>
			<if test="baby_no != null and baby_no != ''">
				BABY_NO = #{baby_no}
			</if>
		</where>
	</select>
	<select id="getVacList" resultType="checkupVO">
		SELECT * FROM CHECKUP
		<where>
			<if test="baby_no != null and baby_no != ''">
				CHK_NO NOT IN(SELECT H.CHK_NO
				FROM CHECKHIST H, RESERVATION R
				WHERE R.BABY_NO = #{baby_no})
			</if>
		</where>
		ORDER BY CHK_NO
	</select>

	<!-- SELECT COUNT(RESV_TIME), RESV_TIME -->
	<!-- FROM RESERVATION -->
	<!-- WHERE TO_CHAR(RESV_DATE, 'YYYY-MM-DD') = '2021-01-12' -->
	<!-- GROUP BY RESV_TIME -->
	<!-- ORDER BY RESV_TIME; -->

	<insert id="questInsert" parameterType="questionVO">
		INSERT INTO
		QUESTION(QUST_NO,A1,A2,A3,A4)
		VALUES (#{qust_no},
		#{a1},
		#{a2}, #{a3},
		#{a4})
	</insert>

	<insert id="resvInsert" parameterType="reservation">
		<!-- <selectKey order="BEFORE" keyProperty="resv_no" -->
		<!-- resultType="String"> -->
		<!-- SELECT NVL(MAX(RESV_NO),0)+1 FROM RESERVATION -->
		<!-- </selectKey> -->
		INSERT INTO RESERVATION(resv_no, resv_date, resv_time
		<if test="resv_detail != null and resv_detail != ''">
			, resv_detail
		</if>
		<if test="resv_memo != null and resv_memo != ''">
			, resv_memo
		</if>
		, baby_no, chk_no, chk_type, resv_type)
		VALUES (#{resv_no},
		#{resv_date}, #{resv_time}
		<if test="resv_detail != null and resv_detail != ''">
			, #{resv_detail}
		</if>
		<if test="resv_memo != null and resv_memo != ''">
			, #{resv_memo}
		</if>
		, #{baby_no}, #{chk_no}, #{chk_type}, #{resv_type})
	</insert>
</mapper>